# LoRa®调制(物理层)   

## 基础概念
### chirp

(Chirp: Compressed High Intensity Radar Pulse).
![[Pasted image 20240321123643.png]]

啁啾脉冲的形式如上图所示，
起始频率是信道频率减去带宽除以2。最后的频率是信道频率加上带宽除以2。图9表示频域中的LoRa调制。
小练习
A LoRa transmission uses the 868,1 MHz channel with a bandwidth of 125 kHz. Can you 
give the start and end frequency of the Chirp?

start: 8681000000 -125000/2 =868 037 500 Hz 
end : 868 162 500 Hz = 868 100 000 + 125 000/2
### 对symbol（chirp）的理解

根本性的理解---例如找一个 SF2 来做展示： 
有4种可能的组合：

1. 00
2. 01
3. 10
4. 11

因此，在SF2编码模式下，你会有4种不同的符号（Chirps），每种符号对应于上面的一种组合。这些符号在传输过程中通过变化其频率的起始点来区分。即使所有符号都会覆盖相同的频率范围并且都有相同的长度和形状，每个符号的频率变化开始点都是唯一的，这样接收器就能区分它们代表的是哪两位二进制代码。

在实际的LoRa系统中，符号是通过频率扫描来实现的。例如，如果我们有一个125kHz的带宽和868.1MHz的中心频率（这是一个典型的LoRa频段），SF2模式下的频率扫描可能是这样的：

- 符号0（代表二进制00）可能从868.075MHz开始，增加到868.2MHz。
- 符号1（代表二进制01）可能从868.085MHz开始，同样增加到868.2MHz。
- 符号2（代表二进制10）可能从868.095MHz开始，增加到868.2MHz。
- 符号3（代表二进制11）可能从868.105MHz开始，增加到868.2MHz。

举个具体的例子，如果你要发送一个二进制序列 `110010`，在SF2下，你会将这个序列分成每2位一组，即 `11` `00` `10`。然后，根据每组的不同，你会发送对应的符号。所以对于 `11`，你会发送符号3，对于 `00`，你会发送符号0，对于 `10`，你会发送符号2。这样，接收器只需要识别出每个符号的起始频率，就可以知道每个符号代表的是哪两位二进制数据了。
![[Pasted image 20240321181526.png]]

### 符号传输时间
![[Pasted image 20240321181633.png]]
在中心频率和带宽一致的情况下 传输时间取决于 SF值， 

具体计算公式
$T_{symbol} =\frac{2^{SF}}{BD width}$
在125KHZ情况下，不同SF值传输的时间
![[Pasted image 20240321182520.png]]
### Lora 在空气中的传输时间
Lora具体的一帧数据包括了，payload，preamble，CRC 三部分
![[Pasted image 20240321182730.png]]
$Time\ on\ air = n_{symbol}*T{symbol}$
$n_{symbol}$是lora的一帧数据的总的字节数

## LoRa® and LoRaWAN® bit rate
### Lora bit rate
计算公式：

$Bit\ Rate= SF*\frac{BDwidth}{2^{SF}}$
#### 案例1（SF7, 125 kHz）

- **扩频因子（SF）**：7
- **带宽（BW）**：125 kHz

计算比特率：

$[ \text{Bit Rate}_{\text{1}} = \frac{7 \times 125,000}{2^7} = \frac{875,000}{128} \approx 6835.94 \, \text{bps}]$
#### 案例2（SF12, 125 kHz）

- **扩频因子（SF）**：12
- **带宽（BW）**：125 kHz

计算比特率：

$[ \text{Bit Rate}_{\text{2}} = \frac{12 \times 125,000}{2^{12}} = \frac{1,500,000}{4096} \approx 366.21 \, \text{bps} ]$

因此，案例1的比特率大约为6836 bps，案例2的比特率大约为366 bps。这表明在LoRa通信中，较高的扩频因子会减少比特率，但可以增强信号的穿透力和覆盖范围。

## 